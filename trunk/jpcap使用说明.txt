1.Download and install the latest WinPcap.
2.下载
Jpcap ver.0.5.1		jpcap-0.5.1.zip
3.编译jpcap 源码
4. Download and run Self Installer.  安装JDK版
5. copy jpcap.jar 到 "[JDK directory]\jre\lib\ext".
6. 接受报文
import jpcap.*; import jpcap.packet.Packet; class Tcpdump implements PacketReceiver { public void receivePacket(Packet packet) {
//此时解析报文,如果packet的IP协议为253,或者254
进行规范处理其应用层报文 System.out.println(packet); } public static void main(String[] args) throws Exception { NetworkInterface[] devices = JpcapCaptor.getDeviceList(); JpcapCaptor jpcap = JpcapCaptor.openDevice(devices[2],2000, false, 20); jpcap.loopPacket(-1, new Tcpdump()); } }
 
7.发送报文
import java.net.InetAddress; import jpcap.*; import jpcap.packet.EthernetPacket; import jpcap.packet.IPPacket; import jpcap.packet.TCPPacket; class SendTCP { public static void main(String[] args) throws java.io.IOException{ NetworkInterface[] devices = JpcapCaptor.getDeviceList(); JpcapSender sender=JpcapSender.openDevice(devices[2]); TCPPacket p=new TCPPacket(12,34,56,78,false,false,false,false,true,true,true,true,10,10); p.setIPv4Parameter(0,false,false,false,0,false,false,false,0,1010101,100,IPPacket.IPPROTO_TCP, InetAddress.getByName("www.microsoft.com"),InetAddress.getByName("www.google.com")); p.data="data".getBytes(); EthernetPacket ether=new EthernetPacket(); ether.frametype=EthernetPacket.ETHERTYPE_IP; ether.src_mac=new byte[]{(byte)0,(byte)1,(byte)2,(byte)3,(byte)4,(byte)5}; ether.dst_mac=new byte[]{(byte)0,(byte)6,(byte)7,(byte)8,(byte)9,(byte)10}; p.datalink=ether; for(int i=0;i<10;i++) sender.sendPacket(p); } }